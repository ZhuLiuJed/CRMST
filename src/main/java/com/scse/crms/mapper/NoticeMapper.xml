<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Config 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.scse.crms.mapper.NoticeMapper">
  <select id="selectNoticeForClasses" parameterType="List" resultType="com.scse.crms.po.Notice">
    SELECT * FROM notice WHERE 1=1 <!-- AND target LIKE CONCAT(CONCAT('%', #{target},'%')) -->
    <foreach item="item" collection="list" separator="OR" open="AND(" close=")" index="">  
      target LIKE CONCAT(CONCAT('%', #{item.target}),'%')
    </foreach>
  </select>
  <select id="selectNoticeForTeacher" parameterType="String" resultType="com.scse.crms.po.Notice">
    SELECT * FROM notice WHERE tid=#{tid}
  </select>
  <select id="selectClassesBySid" parameterType="String" resultType="com.scse.crms.po.Notice">
    SELECT classid as target FROM classes_student WHERE sid=#{sid}
  </select>
  
  <insert id="addNotice" parameterType="com.scse.crms.po.Notice">
    INSERT notice VALUE(UNIX_TIMESTAMP(NOW()), #{tid}, #{title}, #{content}, #{target}, CURDATE(), #{effective})
  </insert>
  
  <delete id="deleteNoticeById" parameterType="String">
    DELETE FROM notice WHERE id=#{id}
  </delete>
</mapper>